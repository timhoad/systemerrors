<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Can You Handle The Truth?</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=OCR+A+Std&display=swap"
      rel="stylesheet"
    />
    <style>
      @font-face { font-family:OCR A Std; src: url('ocr-a-std.ttf'); }
      div {font-family:OCR A Std;}
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        background: #000;
        overflow-x: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
      }
      .crt {
        background: repeating-linear-gradient(
          to bottom,
          #111,
          #111 2px,
          #0d0d0d 4px,
          #111 6px
        );
        border: 2px solid white;
        border-radius: 12px;
        padding: 20px;
        color: white;
        font-size: 0.8rem;
        width: 60vw;
        max-width: 600px;
        margin-top: 30px;
        margin-bottom: 60px;
        position: relative;
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
        text-align: center;
        box-sizing: border-box;
      }
      .typewriter-container {
        display: inline-block;
        white-space: pre-line;
        text-align: left;
        width: 100%;
        vertical-align: top;
      }
      .cursor,
      .completion-cursor {
        display: inline-block;
        width: 10px;
        height: 1em;
        background-color: white;
        animation: blink 0.7s infinite;
        vertical-align: bottom;
        margin-left: 2px;
      }
      @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0; }
      }
      .letters-container {
        position: relative;
        width: 60vw;
        max-width: 600px;
        height: 30vh;
        margin-bottom: 10px;
        display: none;
      }
      .draggable-letter {
        position: absolute;
        color: white;
        font-weight: bold;
        font-size: 1.2rem;
        cursor: grab;
        animation: pulse 3s infinite ease-in-out;
        user-select: none;
        touch-action: none;
      }
      @keyframes pulse {
        0%, 100% {
          transform: scale(1);
          opacity: 0.8;
        }
        50% {
          transform: scale(1.1);
          opacity: 1;
        }
      }
      @keyframes glitch {
        0% { transform: translate(1px, 0); opacity: 1; }
        20% { transform: translate(-1px, 0); opacity: 0.7; }
        40% { transform: translate(1px, 0); opacity: 1; }
        60% { transform: translate(-1px, 0); opacity: 0.7; }
        80% { transform: translate(1px, 0); opacity: 1; }
        100% { transform: translate(0, 0); opacity: 1; }
      }
      .drop-zone {
        display: none;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 20px;
        flex-shrink: 0;
      }
      .drop-row {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 8px;
      }
      .drop-slot {
        width: 20px;
        height: 24px;
        border-bottom: 2px solid white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        font-weight: bold;
        color: white;
      }
      .drop-slot.filled {
        border-bottom: none;
      }
      .form-container {
        background: #222;
        padding: 20px;
        color: white;
        border-radius: 8px;
        border: 1px solid #444;
        width: 90%;
        max-width: 400px;
        display: none;
        flex-direction: column;
        align-items: center;
        text-align: center;
      }
      .form-container input {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        background: transparent;
        border: 1px solid white;
        color: white;
      }
      .form-container button {
        background: white;
        color: black;
        font-weight: bold;
        border: none;
        padding: 10px;
        width: 100%;
        cursor: pointer;
      }
      .completion-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: black;
        color: white;
        display: none;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        z-index: 9999;
        transition: background 0.8s;
      }
      .completion-overlay.faded {
        background: #000;
        transition: background 1.2s;
      }
      .completion-message {
        font-size: 1.5rem;
        font-weight: bold;
        text-align: center;
        white-space: pre-line;
        margin-bottom: 2em;
        z-index: 2;
        display: inline-block;
      }
      /* Center the final text line on the overlay for desktop and mobile */
      .completion-overlay .typewriter-container {
        width: 100%;
        max-width: 600px;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      .completion-overlay .typewriter-container > * {
        /* Ensure inline flow for message+cursor */
        display: inline-block;
        vertical-align: middle;
      }
      /* Fade in for zoho form */
      #zoho-campaigns-form {
        opacity: 0;
        transition: opacity 1.2s;
      }
      #zoho-campaigns-form.visible {
        opacity: 1;
      }
      /* --- Start Zoho Form Responsive (from your embed) --- */
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #customForm *:not(.dateClass){
      -webkit-box-sizing: border-box !important;
      -moz-box-sizing: border-box !important;
      box-sizing: border-box !important;
      word-break:break-word;
      overflow-wrap: break-word;
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .dateClass{
      -webkit-box-sizing: unset!important;
      -moz-box-sizing: unset !important;
      box-sizing: unset !important;
      word-break:break-word;
      overflow-wrap: break-word;
      }
      @media only screen and (max-width: 200px){
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #signupMainDiv{
      width:220px !important;
      min-width:220px !important;
      margin: 0px auto !important;
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #SIGNUP_PAGE{
      padding:0px !important  
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .recaptcha{
      transform:scale(0.55);-webkit-transform:scale(0.45);transform-origin:0 0;-webkit-transform-origin:0 0;}
      }
      @media only screen and (min-width: 440px) and (max-width:600px){
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #signupMainDiv{
      width:440px !important;
      min-width:440px !important;
      margin: 0px auto !important;  
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .recaptcha{
      transform:scale(0.72);-webkit-transform:scale(0.55);transform-origin:0 0;-webkit-transform-origin:0 0;}
      }
      @media only screen and (min-width: 320px) and (max-width:440px){
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #signupMainDiv{
      width:320px !important;
      min-width:320px !important;
      margin: 0px auto !important;    
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .recaptcha{
      transform:scale(0.72);-webkit-transform:scale(0.55);transform-origin:0 0;-webkit-transform-origin:0 0;}
      }
      @media only screen  and (min-width : 1224px) {
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #signupMainDiv{
      width:600px !important;
      min-width:600px !important;
      margin: 0px auto !important;  
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .recaptcha{
      transform:scale(1.03);-webkit-transform:scale(1.08);transform-origin:0 0;-webkit-transform-origin:0 0;}
      }
      @media only screen  and (min-width : 1824px) {
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #signupMainDiv{
      width:600px !important;
      min-width:600px !important;
      margin: 0px auto !important;  
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .recaptcha{
      transform:scale(1.03);-webkit-transform:scale(1.08);transform-origin:0 0;-webkit-transform-origin:0 0;}
      }
      @media only screen and (min-device-width : 601px) and (max-device-width : 1024px) {
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf #signupMainDiv{
      width:600px !important;
      min-width:600px !important;
      margin: 0px auto !important;  
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .recaptcha{
      transform:scale(0.90);-webkit-transform:scale(0.90);transform-origin:0 0;-webkit-transform-origin:0 0;}
      }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .bdr_btm_hover{background-color:#f9f9f9; padding:10px;}
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .bdr_btm{padding:10px }
      #sf3zbe03df9d942164034b7a52413ddd2de2d8307e7c4e1dabf9b3993994fac09cdf .f14{font-size:14px}
      /* --- End Zoho Form Responsive --- */
    </style>
  </head>
  <body>
    <div class="crt" id="riddle-box">
      <span class="typewriter-container">
        <span id="riddle-text"></span><span class="cursor" id="riddle-cursor"></span>
      </span>
    </div>

    <div style="font-family:OCR A Std" class="letters-container" id="letters-container"></div>

    <div style="font-family:OCR A Std" class="drop-zone" id="drop-zone">
      <div style="font-family:OCR A Std" class="drop-row" id="row1"></div>
      <div style="font-family:OCR A Std" class="drop-row" id="row2"></div>
    </div>

    <div class="form-container" id="form-container">
      <h3>Start pulling the strings here</h3>
      <p>
        access - knowledge, tools for critical thinking, breakdowns, product
        activism
      </p>
      <input type="email" placeholder="Email" />
      <input type="text" placeholder="First Name" />
      <input type="text" placeholder="Surname" />
      <input type="text" placeholder="Country" />
      <button>Stand Together</button>
    </div>

    <div style="font-family:OCR A Std" class="completion-overlay" id="completion-overlay">
      <span class="typewriter-container">
        <span class="completion-message" id="final-message"></span><span class="completion-cursor" id="final-cursor"></span>
      </span>
      <!-- ZOHO CAMPAIGNS FORM (hidden by default, revealed after fade) -->
      <div id="zoho-campaigns-form" style="display:none; width:100%; max-width:600px; margin:0 auto;">
        <!-- FULL ZOHO FORM CODE GOES HERE (AS IN YOUR ORIGINAL 717-LINE FILE) -->
      </div>
      <!-- END ZOHO FORM -->
    </div>

    <script>
      // Typewriter effect for riddle text
      const riddle = `They built a house on shifting sand,
Then sold the myth with sleight of hand.
Truth trades hands behind closed doors,
Sanitized for distant shores.
The loudest claim "It’s all just fine",
While cracks appear in every line.
Eyes wide shut, we seek the key,
Solve the puzzle and begin to see.`;
      const riddleText = document.getElementById("riddle-text");
      const riddleCursor = document.getElementById("riddle-cursor");
      let riddleIndex = 0;
      function typeRiddle() {
        if (riddleIndex < riddle.length) {
          riddleText.textContent += riddle[riddleIndex];
          riddleIndex++;
          setTimeout(typeRiddle, 40);
        } else {
          setTimeout(() => {
            const lettersContainer = document.getElementById("letters-container");
            const dropZone = document.getElementById("drop-zone");
            lettersContainer.style.display = "block"; // Reveal scrambled letters
            initializeDropZones(); // Initialize drop zones for mobile or desktop
            dropZone.style.display = "flex"; // Show the drop zone
          }, 300);
        }
      }
      typeRiddle();

      // Word Scramble Game Setup
      const phrase = "CAN YOU HANDLE THE TRUTH?";
      const cleanPhrase = phrase.replace(/\s/g, "");
      const letters = cleanPhrase.split("").sort(() => Math.random() - 0.5);
      const container = document.getElementById("letters-container");
      let correctCount = 0;

      // Function to add drop slots to a row based on the text provided
      function addSlots(row, text) {
        for (const char of text) {
          if (char === " ") {
            const spacer = document.createElement("div");
            spacer.style.width = "15px";
            row.appendChild(spacer);
          } else {
            const slot = document.createElement("div");
            slot.classList.add("drop-slot");
            row.appendChild(slot);
          }
        }
      }

      // Initialize drop zones:
      function initializeDropZones() {
        const dropZone = document.getElementById("drop-zone");
        dropZone.innerHTML = ""; // Clear any existing rows

        if (window.innerWidth < 768) {
          // Mobile: Setup three rows
          const row1 = document.createElement("div");
          row1.classList.add("drop-row");
          row1.id = "row1";
          const row2 = document.createElement("div");
          row2.classList.add("drop-row");
          row2.id = "row2";
          const row3 = document.createElement("div");
          row3.classList.add("drop-row");
          row3.id = "row3";
          dropZone.appendChild(row1);
          dropZone.appendChild(row2);
          dropZone.appendChild(row3);
          addSlots(row1, "CAN YOU");
          addSlots(row2, "HANDLE");
          addSlots(row3, "THE TRUTH?");
        } else {
          // Desktop: Two rows
          const row1 = document.createElement("div");
          row1.classList.add("drop-row");
          row1.id = "row1";
          const row2 = document.createElement("div");
          row2.classList.add("drop-row");
          row2.id = "row2";
          dropZone.appendChild(row1);
          dropZone.appendChild(row2);
          addSlots(row1, "CAN YOU HANDLE");
          addSlots(row2, "THE TRUTH?");
        }
      }

      // Avoid overlapping initial positions for letters:
      const letterPositions = [];
      function getRandomPosition() {
        let position;
        let isOverlap = true;
        while (isOverlap) {
          position = {
            x: Math.random() * 90,
            y: Math.random() * 90,
          };
          isOverlap = letterPositions.some(
            (p) =>
              Math.abs(p.x - position.x) < 10 &&
              Math.abs(p.y - position.y) < 10
          );
        }
        letterPositions.push(position);
        return position;
      }

      // Pointer Events for Drag & Drop
      let currentLetter = null;
      let pointerOffsetX = 0, pointerOffsetY = 0;
      function onPointerDown(event) {
        currentLetter = event.target;
        if (!currentLetter.dataset.origLeft) {
          currentLetter.dataset.origLeft = currentLetter.style.left;
          currentLetter.dataset.origTop = currentLetter.style.top;
        }
        currentLetter.setPointerCapture(event.pointerId);
        const letterRect = currentLetter.getBoundingClientRect();
        pointerOffsetX = event.clientX - letterRect.left;
        pointerOffsetY = event.clientY - letterRect.top;
        currentLetter.style.zIndex = 1000;
        currentLetter.addEventListener("pointermove", onPointerMove);
        currentLetter.addEventListener("pointerup", onPointerUp);
        currentLetter.addEventListener("pointercancel", onPointerUp);
      }

      function onPointerMove(event) {
        if (!currentLetter) return;
        const containerRect = container.getBoundingClientRect();
        let newLeft = event.clientX - containerRect.left - pointerOffsetX;
        let newTop = event.clientY - containerRect.top - pointerOffsetY;
        currentLetter.style.left = `${newLeft}px`;
        currentLetter.style.top = `${newTop}px`;
      }

      function onPointerUp(event) {
        if (!currentLetter) return;
        const letterRect = currentLetter.getBoundingClientRect();
        const letterCenterX = letterRect.left + letterRect.width / 2;
        const letterCenterY = letterRect.top + letterRect.height / 2;
        let dropped = false;
        const slots = document.querySelectorAll(".drop-slot");
        slots.forEach((slot, index) => {
          const slotRect = slot.getBoundingClientRect();
          if (
            letterCenterX >= slotRect.left &&
            letterCenterX <= slotRect.right &&
            letterCenterY >= slotRect.top &&
            letterCenterY <= slotRect.bottom &&
            !slot.classList.contains("filled")
          ) {
            const correctChar = cleanPhrase[index];
            if (currentLetter.textContent === correctChar) {
              slot.textContent = currentLetter.textContent;
              slot.classList.add("filled");
              slot.style.animation = "glitch 0.3s ease-out";
              setTimeout(() => {
                slot.style.animation = "";
              }, 300);
              currentLetter.style.display = "none";
              correctCount++;
              dropped = true;
            }
          }
        });
        if (!dropped) {
          currentLetter.style.left = currentLetter.dataset.origLeft;
          currentLetter.style.top = currentLetter.dataset.origTop;
        }
        currentLetter.style.zIndex = "";
        currentLetter.removeEventListener("pointermove", onPointerMove);
        currentLetter.removeEventListener("pointerup", onPointerUp);
        currentLetter.removeEventListener("pointercancel", onPointerUp);
        currentLetter = null;

        if (correctCount === cleanPhrase.length) {
          setTimeout(() => {
            document.getElementById("completion-overlay").style.display = "flex";
            showFinalMessage();
          }, 500);
        }
      }

      // Create draggable letters.
      letters.forEach((char, i) => {
        const letter = document.createElement("div");
        letter.classList.add("draggable-letter");
        letter.textContent = char;
        letter.dataset.index = i;
        const { x, y } = getRandomPosition();
        letter.style.left = `${x}%`;
        letter.style.top = `${y}%`;
        container.appendChild(letter);
        letter.addEventListener("pointerdown", onPointerDown);
      });

      // Audio setup remains as before.
      const audio = new Audio("https://archive.org/download/rumbling/rumbling.mp3");
      audio.loop = true;
      function startAudio() {
        audio.play().catch((err) => {
          console.warn("Autoplay blocked:", err);
        });
        window.removeEventListener("click", startAudio);
        window.removeEventListener("touchstart", startAudio);
      }
      window.addEventListener("click", startAudio);
      window.addEventListener("touchstart", startAudio);

      // FINAL MESSAGE TYPEWRITER
      function showFinalMessage() {
        const finalMsg = document.getElementById("final-message");
        const finalCursor = document.getElementById("final-cursor");
        const text = "you persevered, where most don’t even try...";
        let idx = 0;
        finalMsg.textContent = "";
        finalCursor.style.display = "inline-block";
        function typeFinal() {
          if (idx < text.length) {
            finalMsg.textContent += text[idx];
            idx++;
            setTimeout(typeFinal, 70);
          } else {
            setTimeout(() => {
              document.getElementById("completion-overlay").classList.add("faded");
              const zohoForm = document.getElementById('zoho-campaigns-form');
              zohoForm.style.display = 'block';
              setTimeout(() => {
                zohoForm.classList.add('visible');
              }, 50);
              setTimeout(() => {
                finalCursor.style.display = "none";
              }, 1200);
            }, 1500);
          }
        }
        typeFinal();
      }
    </script>
  </body>
</html>